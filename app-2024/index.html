<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>App 2024</title>
  <script type="module">
    function setUpButtons() {

      const getAndShowButton = document.getElementById("showButton");
      const saveButton = document.getElementById("saveButton");

      getAndShowButton.addEventListener("click", getAndShowAddresses);
      saveButton.addEventListener("click", saveAddress);
    }

    let firstAddress;

    const firstName = document.getElementById("firstName");
    const lastName = document.getElementById("lastName");

    async function getAndShowAddresses() {
      const response = await fetch("http://localhost:20241/addresses");
      const addresses = await response.json();

      const addressListElement = document.getElementById("addresses");
      const addressText = addresses.map(a => `${a.firstName} ${a.lastName}`).join("\n");

      const addressesText = document.createTextNode(addressText);

      addressListElement.textContent = "";
      addressListElement.appendChild(addressesText);

      firstAddress = addresses[0];

      firstName.value = firstAddress.firstName;
      lastName.value = firstAddress.lastName;
    }

    async function saveAddress() {
      firstAddress.firstName = firstName.value;
      firstAddress.lastName = lastName.value;

      const putResponse = await fetch(`http://localhost:20241/addresses/${firstAddress.id}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(firstAddress),
      });

      if (putResponse.ok) {
        alert("Object saved.");
      }
      else {
        alert("Error while saving object.");
      }
    }

    setUpButtons();
    await getAndShowAddresses();

  </script>

  <style>
    html {
      --standard-spacing: 10px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    form {
      display: grid;
      grid-template-columns: minmax(150px, auto) 1fr;
      gap: var(--standard-spacing);
    }

    form *:nth-child(odd) {
      justify-self: end;
    }

    form input {
      align-self: center;
      padding: var(--standard-spacing);
    }

    form label {
      align-self: center;
    }
  </style>
</head>

<body>
  <button id="showButton">Get and show addresses</button>
  <button id="saveButton">Save address</button>
</body>

<div id="addresses" style="background: cornsilk; min-height: 100px;">
</div>

<h1>Formular: Beispiel</h1>
<form>
  <label>First name</label>
  <input list="firstNames" placeholder="vorname" id="firstName">
  <label>Last name</label>
  <input id="lastName">
</form>
<datalist id="firstNames">
  <option value="Joe"></option>
  <option value="Jane"></option>
  <option value="John"></option>
  <option value="Jessica"></option>
</datalist>

</html>